"use strict";(()=>{var Ir=Object.create;var Tt=Object.defineProperty;var Lr=Object.getOwnPropertyDescriptor;var Dr=Object.getOwnPropertyNames;var Kr=Object.getPrototypeOf,wr=Object.prototype.hasOwnProperty;var _=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var Ur=(e,r,n,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Dr(r))!wr.call(e,o)&&o!==n&&Tt(e,o,{get:()=>r[o],enumerable:!(i=Lr(r,o))||i.enumerable});return e};var $=(e,r,n)=>(n=e!=null?Ir(Kr(e)):{},Ur(r||!e||!e.__esModule?Tt(n,"default",{value:e,enumerable:!0}):n,e));var Ce=_(h=>{"use strict";var xt=h&&h.__extends||function(){var e=function(r,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)o.hasOwnProperty(s)&&(i[s]=o[s])},e(r,n)};return function(r,n){e(r,n);function i(){this.constructor=r}r.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(h,"__esModule",{value:!0});h.buildLexer=h.extractByTokenRange=h.extractByPositionRange=h.TokenRangeError=h.TokenError=void 0;function Ae(e){return e===void 0?"<END-OF-FILE>":JSON.stringify(e)}var gt=function(e){xt(r,e);function r(n,i){var o=e.call(this,Ae(n)+": "+i)||this;return o.pos=n,o.errorMessage=i,o}return r}(Error);h.TokenError=gt;var Or=function(e){xt(r,e);function r(n,i,o){var s=e.call(this,Ae(n)+" - "+Ae(i)+": "+o)||this;return s.first=n,s.next=i,s.errorMessage=o,s}return r}(Error);h.TokenRangeError=Or;function St(e,r,n){var i=r===void 0?e.length:r.index,o=n===void 0?e.length:n.index;return i>=o?"":e.substring(i,o)}h.extractByPositionRange=St;function qr(e,r,n){return St(e,r===void 0?void 0:r.pos,n===void 0?void 0:n.pos)}h.extractByTokenRange=qr;var Br=function(){function e(r,n,i,o,s,p){this.lexer=r,this.input=n,this.kind=i,this.text=o,this.pos=s,this.keep=p}return Object.defineProperty(e.prototype,"next",{get:function(){return this.nextToken===void 0&&(this.nextToken=this.lexer.parseNextAvailable(this.input,this.pos.index+this.text.length,this.pos.rowEnd,this.pos.columnEnd),this.nextToken===void 0&&(this.nextToken=null)),this.nextToken===null?void 0:this.nextToken},enumerable:!1,configurable:!0}),e}(),Qr=function(){function e(r){this.rules=r;for(var n=0,i=this.rules;n<i.length;n++){var o=i[n];if(o[1].source[0]!=="^")throw new Error('Regular expression patterns for a tokenizer should start with "^": '+o[1].source);if(!o[1].global)throw new Error("Regular expression patterns for a tokenizer should be global: "+o[1].source)}}return e.prototype.parse=function(r){return this.parseNextAvailable(r,0,1,1)},e.prototype.parseNext=function(r,n,i,o){if(n!==r.length){for(var s=r.substr(n),p,c=0,m=this.rules;c<m.length;c++){var l=m[c],S=l[0],x=l[1],k=l[2];if(x.lastIndex=0,x.test(s)){for(var v=s.substr(0,x.lastIndex),A=i,D=o,B=0,Y=v;B<Y.length;B++){var Rr=Y[B];switch(Rr){case"\r":break;case`
`:A++,D=1;break;default:D++}}var ft=new Br(this,r,k,v,{index:n,rowBegin:i,columnBegin:o,rowEnd:A,columnEnd:D},S);(p===void 0||p.text.length<ft.text.length)&&(p=ft)}}if(p===void 0)throw new gt({index:n,rowBegin:i,columnBegin:o,rowEnd:i,columnEnd:o},"Unable to tokenize the rest of the input: "+r.substr(n));return p}},e.prototype.parseNextAvailable=function(r,n,i,o){for(var s;;){if(s=this.parseNext(r,s===void 0?n:s.pos.index+s.text.length,s===void 0?i:s.pos.rowEnd,s===void 0?o:s.pos.columnEnd),s===void 0)return;if(s.keep)return s}},e}();function zr(e){return new Qr(e)}h.buildLexer=zr});var w=_(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.unableToConsumeToken=F.resultOrError=F.betterError=void 0;function jr(e,r){return e===void 0?r:r===void 0||e.pos===void 0?e:r.pos===void 0||e.pos.index<r.pos.index?r:(e.pos.index>r.pos.index,e)}F.betterError=jr;function Vr(e,r,n){return n?{candidates:e,successful:!0,error:r}:{successful:!1,error:r}}F.resultOrError=Vr;function Wr(e){return{kind:"Error",pos:e===void 0?void 0:e.pos,message:"Unable to consume token: "+(e===void 0?"<END-OF-FILE>":e.text)}}F.unableToConsumeToken=Wr});var oe=_(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.tok=I.str=I.fail=I.succ=I.nil=void 0;var Et=w();function Hr(){return{parse:function(e){return{candidates:[{firstToken:e,nextToken:e,result:void 0}],successful:!0,error:void 0}}}}I.nil=Hr;function Xr(e){return{parse:function(r){return{candidates:[{firstToken:r,nextToken:r,result:e}],successful:!0,error:void 0}}}}I.succ=Xr;function Yr(e){return{parse:function(r){return{successful:!1,error:{kind:"Error",pos:r?.pos,message:e}}}}}I.fail=Yr;function $r(e){return{parse:function(r){return r===void 0||r.text!==e?{successful:!1,error:Et.unableToConsumeToken(r)}:{candidates:[{firstToken:r,nextToken:r.next,result:r}],successful:!0,error:void 0}}}}I.str=$r;function Jr(e){return{parse:function(r){return r===void 0||r.kind!==e?{successful:!1,error:Et.unableToConsumeToken(r)}:{candidates:[{firstToken:r,nextToken:r.next,result:r}],successful:!0,error:void 0}}}}I.tok=Jr});var _t=_(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.combine=void 0;var vt=w();function Zr(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return{parse:function(i){var o=e.parse(i);if(!o.successful)return o;for(var s=o.candidates,p=o.error,c=0,m=r;c<m.length;c++){var l=m[c];if(s.length===0)break;var S=s;s=[];for(var x=0,k=S;x<k.length;x++){var v=k[x],A=l(v.result).parse(v.nextToken);if(p=vt.betterError(p,A.error),A.successful)for(var D=0,B=A.candidates;D<B.length;D++){var Y=B[D];s.push({firstToken:v.firstToken,nextToken:Y.nextToken,result:Y.result})}}}return vt.resultOrError(s,p,s.length!==0)}}}se.combine=Zr});var ue=_(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.seq=void 0;var ht=w();function en(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return{parse:function(n){for(var i,o=[{firstToken:n,nextToken:n,result:[]}],s=0,p=e;s<p.length;s++){var c=p[s];if(o.length===0)break;var m=o;o=[];for(var l=0,S=m;l<S.length;l++){var x=S[l],k=c.parse(x.nextToken);if(i=ht.betterError(i,k.error),k.successful)for(var v=0,A=k.candidates;v<A.length;v++){var D=A[v];o.push({firstToken:x.firstToken,nextToken:D.nextToken,result:x.result.concat([D.result])})}}}return ht.resultOrError(o,i,o.length!==0)}}}ae.seq=en});var Ne=_(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.alt=void 0;var Pt=w();function tn(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return{parse:function(n){for(var i,o=[],s=!1,p=0,c=e;p<c.length;p++){var m=c[p],l=m.parse(n);i=Pt.betterError(i,l.error),l.successful&&(o=o.concat(l.candidates),s=!0)}return Pt.resultOrError(o,i,s)}}}pe.alt=tn});var kt=_(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.alt_sc=void 0;var bt=w();function rn(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return{parse:function(n){for(var i,o=0,s=e;o<s.length;o++){var p=s[o],c=p.parse(n);if(i=bt.betterError(i,c.error),c.successful)return bt.resultOrError(c.candidates,i,!0)}return{successful:!1,error:i}}}}ce.alt_sc=rn});var At=_(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.opt_sc=Q.opt=void 0;var nn=Ne(),on=oe();function sn(e){return nn.alt(e,on.nil())}Q.opt=sn;function an(e){return{parse:function(r){var n=e.parse(r);return n.successful?n:{candidates:[{firstToken:r,nextToken:r,result:void 0}],successful:!0,error:n.error}}}}Q.opt_sc=an});var Ie=_(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.kmid=K.kright=K.kleft=K.apply=void 0;var Re=ue();function de(e,r){return{parse:function(n){var i=e.parse(n);return i.successful?{candidates:i.candidates.map(function(o){return{firstToken:n,nextToken:o.nextToken,result:r(o.result,[n,o.nextToken])}}),successful:!0,error:i.error}:i}}}K.apply=de;function un(e,r){return de(Re.seq(e,r),function(n){return n[0]})}K.kleft=un;function pn(e,r){return de(Re.seq(e,r),function(n){return n[1]})}K.kright=pn;function cn(e,r,n){return de(Re.seq(e,r,n),function(i){return i[1]})}K.kmid=cn});var It=_(y=>{"use strict";var dn=y&&y.__spreadArrays||function(){for(var e=0,r=0,n=arguments.length;r<n;r++)e+=arguments[r].length;for(var i=Array(e),o=0,r=0;r<n;r++)for(var s=arguments[r],p=0,c=s.length;p<c;p++,o++)i[o]=s[p];return i};Object.defineProperty(y,"__esModule",{value:!0});y.lrec_sc=y.lrec=y.list_n=y.list_sc=y.list=y.rep_n=y.repr=y.rep_sc=y.rep=void 0;var U=Ie(),z=w(),J=ue(),ln=oe();function Le(e){var r=Ct(e);return{parse:function(n){var i=r.parse(n);return i.successful?{candidates:i.candidates.reverse(),successful:!0,error:i.error}:i}}}y.rep=Le;function De(e){return{parse:function(r){for(var n,i=[{firstToken:r,nextToken:r,result:[]}];;){var o=i;i=[];for(var s=0,p=o;s<p.length;s++){var c=p[s],m=e.parse(c.nextToken);if(n=z.betterError(n,m.error),m.successful)for(var l=0,S=m.candidates;l<S.length;l++){var x=S[l];x.nextToken!==c.nextToken&&i.push({firstToken:c.firstToken,nextToken:x.nextToken,result:c.result.concat([x.result])})}}if(i.length===0){i=o;break}}return z.resultOrError(i,n,!0)}}}y.rep_sc=De;function Ct(e){return{parse:function(r){for(var n,i=[{firstToken:r,nextToken:r,result:[]}],o=0;o<i.length;o++){var s=i[o],p=e.parse(s.nextToken);if(n=z.betterError(n,p.error),p.successful)for(var c=0,m=p.candidates;c<m.length;c++){var l=m[c];l.nextToken!==s.nextToken&&i.push({firstToken:s.firstToken,nextToken:l.nextToken,result:s.result.concat([l.result])})}}return z.resultOrError(i,n,!0)}}}y.repr=Ct;function Nt(e,r){return{parse:function(n){for(var i,o=[{firstToken:n,nextToken:n,result:[]}],s=0;s<r;s++){for(var p=[],c=0,m=o;c<m.length;c++){var l=m[c],S=e.parse(l.nextToken);if(i=z.betterError(i,S.error),S.successful)for(var x=0,k=S.candidates;x<k.length;x++){var v=k[x];p.push({firstToken:l.firstToken,nextToken:v.nextToken,result:l.result.concat([v.result])})}}if(p.length===0)return{successful:!1,error:i};o=p}return z.resultOrError(o,i,!0)}}}y.rep_n=Nt;function Ke(e){var r=e[0],n=e[1];return dn([r],n)}function mn(e,r){return U.apply(J.seq(e,Le(U.kright(r,e))),Ke)}y.list=mn;function fn(e,r){return U.apply(J.seq(e,De(U.kright(r,e))),Ke)}y.list_sc=fn;function Tn(e,r,n){return n<1?ln.succ([]):n===1?U.apply(e,function(i){return[i]}):U.apply(J.seq(e,Nt(U.kright(r,e),n-1)),Ke)}y.list_n=Tn;function Rt(e){return function(r){for(var n=r[0],i=0,o=r[1];i<o.length;i++){var s=o[i];n=e(n,s)}return n}}function yn(e,r,n){return U.apply(J.seq(e,Le(r)),Rt(n))}y.lrec=yn;function xn(e,r,n){return U.apply(J.seq(e,De(r)),Rt(n))}y.lrec_sc=xn});var Lt=_(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.amb=void 0;function gn(e){return{parse:function(r){var n=e.parse(r);if(!n.successful)return n;for(var i=new Map,o=0,s=n.candidates;o<s.length;o++){var p=s[o],c=i.get(p.nextToken);c===void 0?i.set(p.nextToken,[p]):c.push(p)}return{candidates:Array.from(i.values()).map(function(m){return{firstToken:m[0].firstToken,nextToken:m[0].nextToken,result:m.map(function(l){return l.result})}}),successful:!0,error:n.error}}}}le.amb=gn});var Dt=_(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.errd=j.err=void 0;function Sn(e,r){return{parse:function(n){var i=e.parse(n);return i.successful?i:{successful:!1,error:{kind:"Error",pos:i.error.pos,message:r}}}}}j.err=Sn;function En(e,r,n){return{parse:function(i){var o=e.parse(i);return o.successful?o:{successful:!0,candidates:[{firstToken:i,nextToken:i,result:n}],error:{kind:"Error",pos:o.error.pos,message:r}}}}}j.errd=En});var wt=_(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.expectSingleResult=G.expectEOF=G.rule=void 0;var we=Ce(),Kt=w(),vn=function(){function e(){}return e.prototype.setPattern=function(r){this.parser=r},e.prototype.parse=function(r){if(this.parser===void 0)throw new Error("Rule has not been initialized. setPattern is required before calling parse.");return this.parser.parse(r)},e}();function _n(){return new vn}G.rule=_n;function hn(e){if(!e.successful)return e;if(e.candidates.length===0)return{successful:!1,error:{kind:"Error",pos:void 0,message:"No result is returned."}};for(var r=[],n=e.error,i=0,o=e.candidates;i<o.length;i++){var s=o[i];s.nextToken===void 0?r.push(s):n=Kt.betterError(n,{kind:"Error",pos:s.nextToken===void 0?void 0:s.nextToken.pos,message:'The parser cannot reach the end of file, stops at "'+s.nextToken.text+'" at position '+JSON.stringify(s.nextToken.pos)+"."})}return Kt.resultOrError(r,n,r.length!==0)}G.expectEOF=hn;function Pn(e){if(!e.successful)throw new we.TokenError(e.error.pos,e.error.message);if(e.candidates.length===0)throw new we.TokenError(void 0,"No result is returned.");if(e.candidates.length!==1)throw new we.TokenError(void 0,"Multiple results are returned.");return e.candidates[0].result}G.expectSingleResult=Pn});var Ft=_(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.makeParserModule=V.lazy=void 0;function Ut(e){return{parse:function(r){return e().parse(r)}}}V.lazy=Ut;var bn=function(e,r,n){return Object.defineProperty(e,r,{configurable:!0,writable:!1,enumerable:!0,value:n})};function kn(e){for(var r=Object.create(null),n=function(m,l){r=bn(r,m,Ut(function(){return l(r)}))},i=0,o=Object.entries(e);i<o.length;i++){var s=o[i],p=s[0],c=s[1];n(p,c)}return r}V.makeParserModule=kn});var W=_(g=>{"use strict";var An=g&&g.__createBinding||(Object.create?function(e,r,n,i){i===void 0&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,i){i===void 0&&(i=n),e[i]=r[n]}),P=g&&g.__exportStar||function(e,r){for(var n in e)n!=="default"&&!r.hasOwnProperty(n)&&An(r,e,n)};Object.defineProperty(g,"__esModule",{value:!0});P(Ce(),g);P(w(),g);P(oe(),g);P(_t(),g);P(ue(),g);P(Ne(),g);P(kt(),g);P(At(),g);P(It(),g);P(Ie(),g);P(Lt(),g);P(Dt(),g);P(wt(),g);P(Ft(),g)});var E=[];for(let e=0;e<256;++e)E.push((e+256).toString(16).slice(1));function yt(e,r=0){return(E[e[r+0]]+E[e[r+1]]+E[e[r+2]]+E[e[r+3]]+"-"+E[e[r+4]]+E[e[r+5]]+"-"+E[e[r+6]]+E[e[r+7]]+"-"+E[e[r+8]]+E[e[r+9]]+"-"+E[e[r+10]]+E[e[r+11]]+E[e[r+12]]+E[e[r+13]]+E[e[r+14]]+E[e[r+15]]).toLowerCase()}var Pe,Fr=new Uint8Array(16);function be(){if(!Pe){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Pe=crypto.getRandomValues.bind(crypto)}return Pe(Fr)}var Gr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ke={randomUUID:Gr};function Mr(e,r,n){if(ke.randomUUID&&!r&&!e)return ke.randomUUID();e=e||{};let i=e.random??e.rng?.()??be();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,r){if(n=n||0,n<0||n+16>r.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let o=0;o<16;++o)r[n+o]=i[o];return r}return yt(i)}var C=Mr;var he=$(W());var me=class e{data;constructor(r){this.data=r}unsafeExpectSuccess(){if(this.data.success)return this.data.data;throw new Error("Expected a non-error response from a Result!")}mapS(r){return this.data.success?new e({success:!0,data:r(this.data.data)}):this}mapE(r){return this.data.success?this:new e({success:!1,error:r(this.data.error)})}};function Ue(e){return new me({success:!0,data:e})}function Fe(e){return new me({success:!1,error:e})}var Ot=$(W());var Gt=["const","bool","float","int","uint","break","continue","do","else","for","if","discard","return","switch","case","default","bvec2","bvec3","bvec4","ivec2","ivec3","ivec4","uvec2","uvec3","uvec4","vec2","vec3","vec4","mat2","mat3","mat4","centroid","in","out","inout","uniform","flat","smooth","layout","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","sampler2d","sampler3d","samplercube","sampler2dshadow","samplercubeshadow","sampler2darray","sampler2darrayshadow","isampler2d","isampler3d","isamplercube","isampler2darray","usampler2d","usampler3d","usamplercube","usampler2darray","struct","void","while","invariant","highp","mediump","lowp","true","false","shared","packed","std140","row_major","column_major"],Mt=["*=","/=","%=","+=","-=","<<=",">>=","&=","^=","|=","++","--","==","!=",">=","<=","&&","||","^^","<<",">>","(",")","[","]","{","}",".",",",":","=",";","!","-","~","+","*","/","%","<",">","|","^","&","?"];var qt=(0,Ot.buildLexer)([[!0,new RegExp(Gt.map(e=>`^${e}`).join("|"),"g"),1],[!0,new RegExp(`^(${Mt.map(e=>e.split("").map(r=>`\\${r}`).join("")).join("|")})`,"g"),0],[!1,/^\s+/g,2],[!0,/^(\/\/[^\n]*\n)|^(\/\*[\s\S]*?\*\/)/g,3],[!0,/^[a-zA-Z_][a-zA-Z0-9_]*/g,4],[!0,/^[1-9][0-9]*[uU]?/g,5],[!0,/^0[0-7]*[uU]?/g,6],[!0,/^0[xX][0-9a-fA-F]+[uU]?/g,7],[!0,/^([0-9]+\.[0-9]*|\.[0-9]+)([eE][\+\-]?[0-9]+)?[fF]?/g,8],[!0,/^[0-9]+[eE][\+\-][0-9]+[fF]?/g,8],[!0,/^"[^"]*"/g,9]]);var t=$(W());var T=$(W());var u=(0,T.apply)((0,T.rep_sc)((0,T.tok)(3)),e=>e.map(r=>({comment:r.text})));function fe(e){return(0,T.seq)(u,e)}function f(e){return d(e,r=>r,r=>[])}function M(e){return(0,T.apply)(fe(e),([r,n],[i,o])=>({data:n,comments:[r],range:{start:i?.pos.index,end:o?.pos.index},_isNode:!0}))}function b(e){return(0,T.apply)(e,(r,[n,i])=>({data:r.data,comments:[...r.comments],range:{start:n?.pos.index,end:i?.pos.index},_isNode:!0}))}function d(e,r,n){return(0,T.apply)(fe(e),([i,o])=>({data:r(o),comments:[i,...n(o)]}))}function Bt(e,r,n){return(0,T.apply)(e,i=>({data:r(i),comments:[...n(i)]}))}function Ge(e,r,n){return(0,T.apply)(fe(e),([i,o])=>{let s=r(o);return{data:s.data,comments:[i,...s.comments,...n(o)]}})}function H(e,r,n,i){return(0,T.apply)(fe(e),([o,s])=>{let p=r(s);return{data:n(p.data,s),comments:[o,...i(p.comments,s)]}})}function Qt(e,r,n){return(0,T.apply)(e,(i,[o,s])=>{let p=r(i),c=n(i,p.comments);return{...p,comments:c}})}function Z(e,r,n,i){let o=(s,p,c,m)=>{let[l,S]=n(s,p,c,m);return{data:l,comments:S,range:{start:c,end:m},_isNode:!0}};return(i?T.lrec:T.lrec_sc)((0,T.apply)((0,T.seq)(e,r),([s,p],[c,m])=>o(s,p,c?.pos.index,m?.pos.index)),(0,T.apply)(r,(s,[p,c])=>({data:s,start:p,end:c})),(s,p)=>o(s,p.data,s.range.start,p.end?.pos.index))}function N(e,r,n){return(0,T.lrec_sc)(e,(0,T.seq)(u,n,e),(i,o)=>({data:{type:"binary-op",op:o[1],left:i,right:o[2],_isExpr:!0},comments:[o[0]],range:{start:i.range.start,end:o[2].range.end},_isNode:!0}))}var Te=$(W());function a(e){return(0,Te.apply)((0,Te.str)(e),r=>r.text)}function Nn(e){throw new Error("TODO")}var Vt=(0,t.rule)(),te=(0,t.rule)(),Ee=(0,t.rule)(),Wt=(0,t.rule)(),Rn=(0,t.rule)(),Ht=(0,t.rule)(),re=(0,t.rule)(),Xt=(0,t.rule)(),Yt=(0,t.rule)(),tt=(0,t.rule)(),$t=(0,t.rule)(),ye=(0,t.rule)(),Ci=(0,t.rule)(),Me=(0,t.rule)(),Oe=(0,t.rule)(),qe=(0,t.rule)(),Be=(0,t.rule)(),Qe=(0,t.rule)(),ze=(0,t.rule)(),je=(0,t.rule)(),Ve=(0,t.rule)(),We=(0,t.rule)(),He=(0,t.rule)(),xe=(0,t.rule)(),rt=(0,t.rule)(),O=(0,t.rule)(),Jt=(0,t.rule)(),R=(0,t.rule)(),q=(0,t.rule)(),nt=(0,t.rule)(),it=(0,t.rule)(),Zt=(0,t.rule)(),er=(0,t.rule)(),ot=(0,t.rule)(),tr=(0,t.rule)(),Xe=(0,t.rule)(),rr=(0,t.rule)(),nr=(0,t.rule)(),ir=(0,t.rule)(),Ni=(0,t.rule)(),ve=(0,t.rule)(),or=(0,t.rule)(),Ye=(0,t.rule)(),sr=(0,t.rule)(),ar=(0,t.rule)(),$e=(0,t.rule)(),ur=(0,t.rule)(),ne=(0,t.rule)(),ee=(0,t.rule)(),X=(0,t.rule)(),st=(0,t.rule)(),pr=(0,t.rule)(),at=(0,t.rule)(),cr=(0,t.rule)(),ut=(0,t.rule)(),dr=(0,t.rule)(),lr=(0,t.rule)(),Je=(0,t.rule)(),ge=(0,t.rule)(),pt=(0,t.rule)(),Ze=(0,t.rule)(),et=(0,t.rule)(),Se=(0,t.rule)(),_e=(0,t.rule)(),mr=(0,t.rule)(),ie=(0,t.rule)(),ct=(0,t.rule)(),dt=(0,t.rule)(),fr=(0,t.rule)(),Tr=(0,t.rule)(),lt=(0,t.rule)(),yr=(0,t.rule)(),xr=(0,t.rule)(),gr=(0,t.rule)(),Sr=(0,t.rule)(),Er=(0,t.rule)(),vr=(0,t.rule)(),_r=(0,t.rule)(),hr=(0,t.rule)(),mt=(0,t.rule)(),Pr=(0,t.rule)(),br=(0,t.rule)(),Ri=M((0,t.apply)((0,t.nil)(),()=>({type:"error",why:"Placeholder encountered during parsing!"})));Vt.setPattern(M((0,t.apply)((0,t.tok)(4),e=>({type:"ident",ident:e.text,_isExpr:!0}))));te.setPattern((0,t.alt_sc)(Vt,M((0,t.alt_sc)((0,t.apply)((0,t.alt_sc)((0,t.tok)(5),(0,t.tok)(6),(0,t.tok)(7)),e=>({type:"int",int:e.text[0]=="0"?parseInt(e.text,8):parseInt(e.text),asString:e.text,_isExpr:!0})),(0,t.apply)((0,t.tok)(8),e=>({type:"float",float:parseFloat(e.text),asString:e.text,_isExpr:!0})),(0,t.apply)((0,t.alt_sc)((0,t.str)("true"),(0,t.str)("false")),e=>({type:"bool",bool:e.text=="true",_isExpr:!0})))),Qt((0,t.seq)(u,(0,t.str)("("),R,u,(0,t.str)(")")),e=>e[2],(e,r)=>[e[0],...r,e[3]])));var In=Z((0,t.alt_sc)(re,te),(0,t.seq)(u,(0,t.str)("."),u,Ee),(e,r)=>[{type:"field-access",left:e,right:r[3],_isExpr:!0},[r[0],r[2]]]);Ee.setPattern((0,t.alt_sc)(Z(te,(0,t.seq)(u,(0,t.str)("["),Wt,u,(0,t.str)("]")),(e,r)=>[{left:e,right:r[2],type:"binary-op",op:"[]",_isExpr:!0},[r[0],r[3]]]),Z(te,(0,t.seq)(u,(0,t.alt_sc)((0,t.str)("++"),(0,t.str)("--"))),(e,r)=>[{type:"unary-op",left:e,op:r[1].text,isAfter:!0,_isExpr:!0},[r[0]]]),In,re,te));Wt.setPattern(R);Rn.setPattern(Ht);Ht.setPattern((0,t.alt_sc)(re,Z(Ee,(0,t.seq)(u,(0,t.str)("."),re),(e,r)=>[{type:"function-call-field-access",left:e,right:r[2],_isExpr:!0},[r[0]]])));re.setPattern(b(Ge((0,t.seq)((0,t.alt_sc)(Yt,Xt),u,(0,t.str)(")")),e=>e[0],e=>[e[1]])));Xt.setPattern(H((0,t.seq)(tt,(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("void")))),e=>e[0],(e,r)=>({type:"function-call",identifier:e,isVoid:r[1]!==void 0,args:[],_isExpr:!0}),(e,r)=>[...e,r[1]?.[0]??[]]));Yt.setPattern(H((0,t.seq)(tt,O,(0,t.rep_sc)((0,t.seq)(u,(0,t.str)(","),O))),e=>e[0],(e,r)=>({type:"function-call",identifier:e,isVoid:!1,args:[r[1],...r[2].map(n=>n[2])],_isExpr:!0}),(e,r)=>[...e,...r[2].map(n=>n[0])]));tt.setPattern(Ge((0,t.seq)($t,u,(0,t.str)("(")),e=>e[0],e=>[e[1]]));$t.setPattern((0,t.alt_sc)(X,f((0,t.apply)((0,t.tok)(4),e=>({type:"function-identifier",identifier:e.text})))));ye.setPattern((0,t.alt_sc)(Ee,M((0,t.apply)((0,t.seq)((0,t.alt_sc)((0,t.str)("--"),(0,t.str)("++"),(0,t.str)("+"),(0,t.str)("-"),(0,t.str)("!"),(0,t.str)("~")),ye),([e,r])=>({type:"unary-op",op:e.text,left:r,isAfter:!1,_isExpr:!0})))));Me.setPattern(N(ye,Me,(0,t.alt_sc)(a("*"),a("/"),a("%"))));Oe.setPattern(N(Me,Oe,(0,t.alt_sc)(a("+"),a("-"))));qe.setPattern(N(Oe,qe,(0,t.alt_sc)(a(">>"),a("<<"))));Be.setPattern(N(qe,Be,(0,t.alt_sc)(a(">"),a("<"),a(">="),a("<="))));Qe.setPattern(N(Be,Qe,(0,t.alt_sc)(a("=="),a("!="))));ze.setPattern(N(Qe,ze,a("&")));je.setPattern(N(ze,je,a("^")));Ve.setPattern(N(je,Ve,a("|")));We.setPattern(N(Ve,We,a("&&")));He.setPattern(N(We,He,a("^^")));xe.setPattern(N(He,xe,a("||")));rt.setPattern((0,t.alt_sc)(b(d((0,t.seq)(xe,u,(0,t.str)("?"),R,u,(0,t.str)(":"),O),e=>({type:"conditional",condition:e[0],ifTrue:e[3],ifFalse:e[6]}),e=>[e[1],e[4]])),xe));O.setPattern((0,t.alt_sc)(b(d((0,t.seq)(ye,u,Jt,O),e=>({type:"assignment",left:e[0],right:e[3],op:e[2],_isExpr:!0}),e=>[e[1]])),rt));Jt.setPattern((0,t.alt_sc)(a("="),a("*="),a("/="),a("%="),a("+="),a("-="),a("<<="),a(">>="),a("&="),a("^="),a("|=")));R.setPattern(N(O,R,a(",")));q.setPattern(rt);nt.setPattern((0,t.alt_sc)(d((0,t.seq)(ir,u,(0,t.str)(";")),e=>({type:"declarator-list",declaratorList:e[0],_isDecl:!0}),e=>[e[1]]),d((0,t.seq)((0,t.apply)(ne,e=>e),f((0,t.apply)((0,t.tok)(4),e=>e.text)),u,(0,t.str)("{"),ut,u,(0,t.str)("}"),(0,t.opt_sc)((0,t.seq)(f((0,t.apply)((0,t.tok)(4),e=>e.text)),(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("["),q,u,(0,t.str)("]"))))),u,(0,t.str)(";")),e=>({type:"struct",typeQualifier:e[0],name:e[1],name2:e[7]?.[0],declarationList:e[4],constantExpr:e[7]?.[1]?.[2],_isDecl:!0}),e=>[e[2],e[5],...e[7]?.[1]?[e[7][1][0],e[7][1][3]]:[],e[8]]),d((0,t.seq)(it,u,(0,t.str)(";")),e=>({type:"function-prototype",prototype:e[0],_isDecl:!0}),e=>[e[1]]),d((0,t.seq)((0,t.str)("precision"),at,st,u,(0,t.str)(";")),e=>({type:"type-specifier",precision:e[1],specifier:e[2],_isDecl:!0}),e=>[e[3]]),d((0,t.seq)(ne,u,(0,t.str)(";")),e=>({type:"type-qualifier",typeQualifier:e[0],_isDecl:!0}),e=>[e[1]])));it.setPattern(H((0,t.seq)(Zt,u,(0,t.str)(")")),e=>e[0],e=>e,(e,r)=>[...e,r[1]]));Zt.setPattern((0,t.alt_sc)(er,ot));er.setPattern(H((0,t.seq)(ot,d((0,t.seq)(Xe,(0,t.rep_sc)((0,t.seq)(u,(0,t.str)(","),Xe))),e=>[e[0],...e[1].map(r=>r[2])],e=>e[1].map(r=>r[0]))),e=>e[0],(e,r)=>({...e,parameters:r[1]}),e=>e));ot.setPattern(d((0,t.seq)(ve,f((0,t.apply)((0,t.tok)(4),e=>e.text)),u,(0,t.str)("(")),e=>({fullySpecifiedType:e[0],name:e[1]}),e=>[e[2]]));tr.setPattern(d((0,t.seq)(X,f((0,t.apply)((0,t.tok)(4),e=>e.text)),(0,t.opt_sc)((0,t.seq)((0,t.str)("["),q,u,(0,t.str)("]")))),e=>({typeSpecifier:e[0],identifier:e[1],arraySize:e[2]?.[1]}),e=>[e[2]?.[2]??[]]));Xe.setPattern(f((0,t.apply)((0,t.seq)((0,t.opt_sc)(ur),rr,(0,t.alt_sc)((0,t.apply)(tr,e=>({type:"declarator",declarator:e})),(0,t.apply)(nr,e=>({type:"specifier",specifier:e})))),([e,r,n])=>({parameterTypeQualifier:e,parameterQualifier:r,declaratorOrSpecifier:n}))));rr.setPattern((0,t.alt_sc)(M((0,t.alt_sc)(a("in"),a("out"),a("inout"))),(0,t.nil)()));nr.setPattern(X);var zt=d((0,t.seq)(f((0,t.apply)((0,t.tok)(4),e=>e.text)),(0,t.alt_sc)(d((0,t.seq)((0,t.str)("["),q,u,(0,t.str)("]")),e=>({type:"sized-array",size:e[1]}),e=>[e[2]]),d((0,t.seq)((0,t.str)("["),(0,t.opt_sc)(q),u,(0,t.str)("]"),u,(0,t.str)("="),ge),e=>({type:"initialized-array",size:e[1],initializer:e[6]}),e=>[e[2],e[4]]),d((0,t.seq)(u,(0,t.str)("="),ge),e=>({type:"initialized",initializer:e[2]}),e=>[e[0]]),(0,t.nil)())),e=>({name:e[0],variant:e[1]}),e=>[]);ir.setPattern(f((0,t.apply)((0,t.seq)((0,t.alt_sc)(f((0,t.apply)(ve,e=>({type:"type",declType:e}))),f((0,t.apply)((0,t.str)("invariant"),e=>({type:"invariant"})))),d((0,t.opt_sc)((0,t.seq)(zt,(0,t.rep_sc)((0,t.seq)(u,(0,t.str)(","),zt)))),e=>e?[e[0],...e[1].map(r=>r[2])]:[],e=>e?e[1].map(r=>r[0]):[])),e=>({init:e[0],declarations:e[1]}))));ve.setPattern(f((0,t.apply)((0,t.seq)((0,t.opt_sc)(ne),X),([e,r])=>({specifier:r,qualifier:e}))));or.setPattern(f(a("invariant")));Ye.setPattern(f((0,t.alt_sc)(a("smooth"),a("flat"))));sr.setPattern(H((0,t.seq)((0,t.str)("layout"),u,(0,t.str)("("),ar,u,(0,t.str)(")")),e=>e[3],(e,r)=>e,(e,r)=>[r[1],...e,r[4]]));ar.setPattern(d((0,t.seq)($e,(0,t.rep_sc)((0,t.seq)(u,a(","),$e))),e=>[e[0],...e[1].map(r=>r[2])],e=>e[1].map(r=>r[0])));$e.setPattern((0,t.alt_sc)(d((0,t.seq)((0,t.tok)(4),u,(0,t.str)("="),u,(0,t.alt_sc)((0,t.tok)(5),(0,t.tok)(7),(0,t.tok)(6))),e=>({identifier:e[0].text,value:Nn(e[4].text)}),e=>[e[1],e[3]]),f((0,t.apply)((0,t.alt_sc)((0,t.tok)(4),(0,t.tok)(1)),e=>({identifier:e.text})))));ur.setPattern(f(a("const")));ne.setPattern((0,t.alt_sc)(f((0,t.apply)(ee,e=>({type:"sq",storageQualifier:e}))),f((0,t.apply)((0,t.seq)(sr,(0,t.opt_sc)(ee)),([e,r])=>({type:"lq-sq",layoutQualifier:e,storageQualifier:r}))),f((0,t.apply)((0,t.seq)(Ye,(0,t.opt_sc)(ee)),([e,r])=>({type:"intq-sq",interpolationQualifier:e,storageQualifier:r}))),f((0,t.apply)((0,t.seq)(or,(0,t.opt_sc)(Ye),ee),([e,r,n])=>({type:"invq-intq-sq",interpolationQualifier:r,invariantQualifier:e,storageQualifier:n})))));ee.setPattern(f((0,t.alt_sc)(a("const"),a("in"),a("out"),(0,t.apply)((0,t.seq)((0,t.str)("centroid"),(0,t.str)("in")),()=>"centroid in"),(0,t.apply)((0,t.seq)((0,t.str)("centroid"),(0,t.str)("out")),()=>"centroid out"),a("uniform"))));X.setPattern(d((0,t.seq)((0,t.opt_sc)(at),st),([e,r])=>({type:"type-specifier",specifier:r,precision:e}),e=>[]));st.setPattern(d((0,t.seq)(pr,(0,t.opt_sc)((0,t.seq)(u,(0,t.seq)((0,t.str)("["),(0,t.opt_sc)(q),u,(0,t.str)("]"))))),e=>({typeName:e[0],arrayType:e[1]?e[1][1][1]?{type:"static",size:e[1][1][1]}:{type:"dynamic"}:{type:"none"}}),e=>e[1]?[e[1][0],e[1][1][2]]:[]));pr.setPattern(f((0,t.alt_sc)((0,t.apply)(f((0,t.alt_sc)((0,t.alt_sc)(a("void"),a("float"),a("int"),a("uint"),a("bool"),a("vec2"),a("vec3"),a("vec4"),a("bvec2"),a("bvec3"),a("bvec4"),a("ivec2"),a("ivec3"),a("ivec4"),a("uvec2"),a("uvec3")),(0,t.alt_sc)(a("uvec4"),a("mat2"),a("mat3"),a("mat4"),a("mat3x2"),a("mat3x3"),a("mat3x4"),a("mat4x2"),a("mat4x3"),a("mat4x4")),(0,t.alt_sc)(a("sampler2D"),a("sampler3D"),a("samplerCube"),a("sampler2DShadow"),a("samplerCubeShadow"),a("sampler2DArray"),a("sampler2DArrayShadow"),a("isampler2D"),a("isampler3D"),a("isamplerCube"),a("isampler2DArray"),a("usampler2D"),a("usampler3D"),a("usamplerCube"),a("usampler2DArray")))),e=>({type:"builtin",name:e})),(0,t.apply)(cr,e=>({type:"struct",struct:e})),(0,t.apply)(f((0,t.apply)((0,t.tok)(4),e=>e.text)),e=>({type:"custom",name:e})))));at.setPattern(f((0,t.alt_sc)(a("highp"),a("mediump"),a("lowp"))));cr.setPattern(d((0,t.seq)((0,t.str)("struct"),(0,t.opt_sc)(f((0,t.apply)((0,t.tok)(4),e=>e.text))),u,(0,t.str)("{"),ut,u,(0,t.str)("}")),e=>({members:e[4],name:e[1],_isStruct:!0}),e=>[e[2],e[5]]));ut.setPattern(f((0,t.rep_sc)(dr)));dr.setPattern(d((0,t.seq)((0,t.opt_sc)(ne),X,lr,u,(0,t.str)(";")),e=>({typeQualifier:e[0],typeSpecifier:e[1],declaratorList:e[2]}),e=>[e[3]]));lr.setPattern(d((0,t.seq)(Je,(0,t.rep_sc)((0,t.seq)(u,(0,t.str)(","),Je))),e=>[e[0],...e[1].map(r=>r[2])],e=>e[1].map(r=>r[0])));Je.setPattern(d((0,t.seq)((0,t.tok)(4),(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("["),(0,t.opt_sc)(q),u,(0,t.str)("]")))),e=>({name:e[0].text,isArray:e[1]?{expr:e[1]?.[2]}:void 0}),e=>e[1]?[e[1][0],e[1][3]]:[]));ge.setPattern(O);pt.setPattern(M((0,t.apply)(nt,e=>({type:"declaration",decl:e,_isStmt:!0}))));Ze.setPattern((0,t.alt_sc)(mr,_e));et.setPattern((0,t.alt_sc)(ie,_e));Se.setPattern((0,t.alt_sc)(ie,_e));_e.setPattern((0,t.alt_sc)(dt,pt,fr,yr,gr,Sr,hr));mr.setPattern(ie);ie.setPattern(b(d((0,t.seq)((0,t.str)("{"),(0,t.opt_sc)(ct),u,(0,t.str)("}")),e=>({type:"compound",statements:e[1]??[],_isStmt:!0}),e=>[e[2]])));ct.setPattern((0,t.apply)((0,t.seq)(Ze,(0,t.rep_sc)(Ze)),([e,r])=>[e,...r]));dt.setPattern(b(d((0,t.seq)((0,t.opt_sc)(R),u,(0,t.str)(";")),e=>({type:"expr",expr:e[0],_isStmt:!0}),e=>[e[1]])));fr.setPattern(b(d((0,t.seq)((0,t.str)("if"),u,(0,t.str)("("),R,u,(0,t.str)(")"),Tr),e=>({type:"selection",cond:e[3],rest:e[6],_isStmt:!0}),e=>[e[1],e[4]])));Tr.setPattern(d((0,t.seq)(Se,(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("else"),Se))),e=>({if:e[0],else:e[1]?.[2],_isStmt:!0}),e=>e[1]?[e[1][0]]:[]));lt.setPattern((0,t.alt_sc)(f((0,t.apply)(R,e=>({type:"expr",expr:e}))),d((0,t.seq)(ve,f((0,t.apply)((0,t.tok)(4),e=>e.text)),u,(0,t.str)("="),ge),e=>({type:"type-equal-init",fullySpecifiedType:e[0],name:e[1],initializer:e[4]}),e=>[e[2]])));yr.setPattern(b(d((0,t.seq)((0,t.str)("switch"),u,(0,t.str)("("),R,u,(0,t.str)(")"),u,(0,t.str)("{"),xr,u,(0,t.str)("}")),e=>({type:"switch",expr:e[3],stmts:e[8]??[],_isStmt:!0}),e=>[e[1],e[4],e[6],e[9]])));xr.setPattern((0,t.opt_sc)(ct));gr.setPattern(b((0,t.alt_sc)(d((0,t.seq)((0,t.str)("case"),R,u,(0,t.str)(":")),e=>({type:"case",expr:e[1],_isStmt:!0}),e=>[e[2]]),d((0,t.seq)((0,t.str)("default"),u,(0,t.str)(":")),e=>({type:"default-case",_isStmt:!0}),e=>[e[1]]))));Sr.setPattern(b((0,t.alt_sc)(d((0,t.seq)((0,t.str)("while"),u,(0,t.str)("("),lt,u,(0,t.str)(")"),et),e=>({type:"while",cond:e[3],body:e[6],_isStmt:!0}),e=>[e[1],e[4]]),d((0,t.seq)((0,t.str)("do"),Se,u,(0,t.str)("while"),u,(0,t.str)("("),R,u,(0,t.str)(")"),u,(0,t.str)(";")),e=>({type:"do-while",cond:e[6],body:e[1],_isStmt:!0}),e=>[e[2],e[4],e[7],e[9]]),d((0,t.seq)((0,t.str)("for"),u,(0,t.str)("("),Er,_r,u,(0,t.str)(")"),et),e=>({type:"for",init:e[3],rest:e[4],body:e[7],_isStmt:!0}),e=>[e[1],e[5]]))));Er.setPattern((0,t.alt_sc)(dt,pt));vr.setPattern((0,t.alt_sc)(lt,(0,t.nil)()));_r.setPattern(d((0,t.seq)(vr,u,(0,t.str)(";"),(0,t.opt_sc)(R)),e=>({condition:e[0],expr:e[3]}),e=>[e[1]]));hr.setPattern(b((0,t.alt_sc)(d((0,t.seq)((0,t.alt_sc)(a("continue"),a("break"),a("discard")),u,(0,t.str)(";")),e=>({type:e[0],_isStmt:!0}),e=>[e[1]]),d((0,t.seq)((0,t.str)("return"),(0,t.opt_sc)(R),u,(0,t.str)(";")),e=>({type:"return",expr:e[1],_isStmt:!0}),e=>[e[2]]))));mt.setPattern(Bt((0,t.seq)((0,t.rep_sc)(Pr),u),e=>e[0],e=>[e[1]]));var jt=b(d((0,t.seq)((0,t.tok)(4),(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("as"),u,(0,t.tok)(4)))),e=>({name:e[0].text,alias:e[1]?.[3].text}),e=>e[1]?[e[1][0],e[1][2]]:[])),Ln=b(d((0,t.seq)((0,t.str)("import"),u,(0,t.alt_sc)(d((0,t.seq)((0,t.str)("*"),(0,t.opt_sc)((0,t.seq)(u,(0,t.str)("as"),u,(0,t.tok)(4)))),e=>({type:"all",prefix:e[1]?.[3]?.text??""}),e=>e[1]?[e[1][0],e[1][2]]:[]),d((0,t.seq)((0,t.str)("{"),(0,t.opt_sc)((0,t.seq)(jt,(0,t.rep_sc)((0,t.seq)(u,(0,t.str)(","),jt)))),u,(0,t.str)("}")),e=>({type:"some",imports:e[1]?[e[1][0],...e[1][1].map(r=>r[2])??[]]:[]}),e=>[...e[1]?.[1].map(r=>r[0])??[],e[2]])),u,(0,t.str)("from"),u,(0,t.tok)(9),u,(0,t.str)(";")),e=>({type:"import",imports:e[2],from:e[6].text.slice(1,-1)}),e=>[e[1],e[5],e[7]]));Pr.setPattern((0,t.alt_sc)(Ln,br,M((0,t.apply)(nt,e=>({type:"declaration",decl:e,_isExtDecl:!0})))));br.setPattern(b(d((0,t.seq)(it,ie),e=>({type:"function",prototype:e[0],body:e[1],_isExtDecl:!0}),e=>[])));function Dn(e){let r=qt.parse(e);return Ue(r)}function kr(e){let r=Dn(e);if(!r.data.success)return Fe(r.data.error);try{let n=(0,he.expectSingleResult)((0,he.expectEOF)(mt.parse(r.data.data)));return Ue({translationUnit:n})}catch(n){return Fe({why:(n??"").toString()})}}function L(e,r){return{count:e,type:r}}function Ar(e){return{float:L(1,"float"),vec2:L(2,"float"),vec3:L(3,"float"),vec4:L(4,"float"),int:L(1,"int"),ivec2:L(2,"int"),ivec3:L(3,"int"),ivec4:L(4,"int"),uint:L(1,"uint"),uvec2:L(2,"uint"),uvec3:L(3,"uint"),uvec4:L(4,"uint")}[e]}function Cr(e){let r={},n={},i={};for(let o of e.data)if(o.data.type==="declaration"){let s=o.data.decl.data;if(s.type==="declarator-list"){let p=s.declaratorList.data.init.data;if(p.type==="type"){let c=p.declType.data.qualifier?.data,m=p.declType.data.specifier.data.specifier.data.typeName.data,l;if(m.type==="builtin"){let S=m.name.data;l=Ar(S),l||(l={type:"sampler",dimensionality:"2D",samplerType:"float"})}if(c&&l){let S=c.storageQualifier?.data==="uniform",x=c.storageQualifier?.data?.endsWith("in"),k=c.storageQualifier?.data?.endsWith("out");for(let v of s.declaratorList.data.declarations.data){let A=v.data.name.data;S?r[A]=l:x&&l.type!=="sampler"?n[A]=l:k&&l.type!=="sampler"&&(i[A]=l)}}}}}return{uniforms:r,inputs:n,outputs:i}}function Nr(e){return{clear(r,n,i){return e({contents:{type:"clear",color:r,depth:n,stencil:i},id:C()})},async createBufferFromArray(r){let{count:n,encoding:i,size:o,array:s}=r;return(await e({id:C(),contents:{type:"create-buffer",id:C(),source:{type:"array",spec:[{count:n,encoding:i,size:o,value:s,name:"attr",stride:0,offset:0}]}}})).content},async linkProgram(r,n){return(await e({id:C(),contents:{type:"create-program",id:C(),vertex:r,fragment:n}})).content},sendGLMessage(r){return e(r)},async draw(r,n,i,o,s){return e({id:C(),contents:{type:"draw",program:r,inputs:i,outputs:o,uniforms:s,count:n}})},async create8BitRGBATexture(r,n,i){return(await e({id:C(),contents:{type:"create-texture",pixels:r,width:n,height:i,internalformat:WebGL2RenderingContext.RGBA8,minFilter:WebGL2RenderingContext.LINEAR,magFilter:WebGL2RenderingContext.LINEAR,wrapS:WebGL2RenderingContext.REPEAT,wrapT:WebGL2RenderingContext.REPEAT,id:C()}})).content},async loadShader(r,n){let i=await e({id:C(),contents:{type:"load-file",path:r}});if(!i.content.file)return;let o=await i.content.file.text(),s=o.replace(/^.*\#version 300 es/,""),p=kr(s);if(!p.data.success)return;let c=p.data.data.translationUnit;return(await e({id:C(),contents:{type:"create-shader",source:{shaderType:n,text:o,...Cr(c)},id:C()}})).content}}}var Kn=Nr(e=>new Promise((r,n)=>{window.addEventListener("message",i=>{i.data?.id===e.id&&r(i.data)}),window.parent.postMessage(e,"*")}));for(let[e,r]of Object.entries(Kn))window[e]=r;})();
//# sourceMappingURL=EvalboxGLWrapper.js.map
